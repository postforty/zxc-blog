# 이미지 업로드 기능 테스트

## 시작하기

### 1. 백엔드 서버 실행

```bash
cd backend
npm run dev
```

서버가 `http://localhost:3001`에서 실행됩니다.

### 2. 프론트엔드 서버 실행

```bash
cd frontend
npm run dev
```

프론트엔드가 `http://localhost:3000`에서 실행됩니다.

## 테스트 시나리오

### ✅ 시나리오 1: 이미지 버튼으로 업로드

1. 로그인 후 게시글 작성 페이지로 이동
2. 한국어 또는 영어 콘텐츠 영역 상단의 이미지 아이콘 버튼 클릭
3. 파일 선택 대화상자에서 이미지 선택 (JPEG, PNG, GIF, WebP)
4. 업로드 중 로딩 스피너 확인
5. 커서 위치에 `![filename](url)` 형식의 마크다운 삽입 확인
6. "미리보기" 버튼 클릭하여 이미지가 정상적으로 표시되는지 확인

**예상 결과:**

```markdown
![image.jpg](http://localhost:3001/api/uploads/temp/uuid-filename.jpg)
```

### ✅ 시나리오 2: 드래그 앤 드롭으로 업로드

1. 로그인 후 게시글 작성 페이지로 이동
2. 파일 탐색기에서 이미지 파일 선택
3. 이미지를 텍스트 영역으로 드래그
4. 텍스트 영역에 드롭
5. 자동으로 업로드되고 마크다운 삽입 확인
6. 미리보기에서 이미지 확인

### ✅ 시나리오 3: 클립보드에서 붙여넣기

1. 로그인 후 게시글 작성 페이지로 이동
2. 스크린샷 캡처 (Windows: Win+Shift+S, Mac: Cmd+Shift+4)
3. 텍스트 영역에 커서 위치
4. Ctrl+V (또는 Cmd+V) 눌러 붙여넣기
5. 자동으로 업로드되고 마크다운 삽입 확인
6. 미리보기에서 이미지 확인

### ✅ 시나리오 4: 파일 크기 제한 테스트

1. 5MB 이상의 이미지 파일 준비
2. 업로드 시도
3. "파일 크기는 5MB를 초과할 수 없습니다" 알림 확인

### ✅ 시나리오 5: 파일 타입 검증 테스트

1. 이미지가 아닌 파일 (PDF, TXT 등) 준비
2. 업로드 시도
3. "이미지 파일만 업로드할 수 있습니다" 알림 확인

### ✅ 시나리오 6: 다국어 독립 업로드

1. 한국어와 영어 모두 선택
2. 한국어 영역에 이미지 업로드
3. 영어 영역에 다른 이미지 업로드
4. 각 영역에 올바른 이미지가 삽입되었는지 확인

### ✅ 시나리오 7: 커서 위치에 삽입

1. 텍스트 영역에 일부 내용 작성
2. 중간 위치에 커서 이동
3. 이미지 업로드
4. 커서 위치에 마크다운이 삽입되는지 확인

## API 테스트 (선택사항)

### cURL로 직접 테스트

```bash
# 1. 로그인하여 토큰 받기
curl -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"your@email.com","password":"yourpassword"}' \
  -c cookies.txt

# 2. 이미지 업로드
curl -X POST http://localhost:3001/api/uploads/images \
  -H "Content-Type: multipart/form-data" \
  -F "image=@/path/to/your/image.jpg" \
  -b cookies.txt

# 3. 임시 이미지 정리
curl -X DELETE http://localhost:3001/api/uploads/cleanup \
  -b cookies.txt
```

## 확인 사항

- [ ] 이미지 버튼 클릭으로 업로드 가능
- [ ] 드래그 앤 드롭으로 업로드 가능
- [ ] 클립보드 붙여넣기로 업로드 가능
- [ ] 업로드 중 로딩 표시
- [ ] 5MB 크기 제한 동작
- [ ] 이미지 파일 타입만 허용
- [ ] 커서 위치에 마크다운 삽입
- [ ] 미리보기에서 이미지 정상 표시
- [ ] 한국어/영어 독립적으로 동작
- [ ] 업로드된 파일이 `backend/uploads/temp/` 폴더에 저장됨

## 문제 해결

### 이미지가 표시되지 않는 경우

- 백엔드 서버가 실행 중인지 확인
- 브라우저 콘솔에서 CORS 에러 확인
- `backend/uploads/temp/` 폴더에 파일이 있는지 확인

### 업로드가 실패하는 경우

- 로그인 상태 확인 (JWT 토큰 필요)
- 파일 크기와 타입 확인
- 백엔드 콘솔에서 에러 로그 확인

### 권한 에러가 발생하는 경우

- `backend/uploads/` 폴더의 쓰기 권한 확인
- Windows: 폴더 속성에서 읽기 전용 해제
